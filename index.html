<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>الکوثر – نماز و تلاوت</title>
  <style>
    :root { --bg:#0b3d2e; --accent:#a3d9c9; --accent-2:#dff3ed; --text:#fff; --btn:#1aa37a; --btn-dark:#108663; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,"Noto Naskh Arabic","Noto Sans Arabic",sans-serif;background:radial-gradient(1200px 700px at 70% -10%,#146c54 0%,#0b3d2e 50%,#06231a 100%);color:var(--text);min-height:100svh;display:grid;place-items:center;padding:24px}
    .app{width:100%;max-width:680px;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:20px;box-shadow:0 10px 40px rgba(0,0,0,.25);backdrop-filter:blur(6px)}
    header{padding:20px 20px 0;text-align:center}
    h1{margin:0 0 6px;font-size:1.6rem;font-weight:800}
    .crumbs{padding:0 20px 10px;color:var(--accent-2)}
    .list{padding:20px;display:grid;gap:12px}
    button.item,button.ayah,button.back{width:100%;border:0;border-radius:16px;padding:16px;text-align:center;cursor:pointer;background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.12);color:#fff;font-size:1.15rem;font-weight:700;box-shadow:0 6px 18px rgba(0,0,0,.25)}
    button.ayah.playing{outline:3px solid var(--accent);box-shadow:0 0 0 4px rgba(163,217,201,.18),0 10px 26px rgba(0,0,0,.35)}
    .controls{display:none;grid-template-columns:1fr 1fr;gap:12px;padding:0 20px 16px}
    .controls.active{display:grid}
    .controls .group{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:10px 12px}
    .controls label{display:block;font-size:.85rem;color:var(--accent-2);margin-bottom:6px}
    .controls input{width:100%}
    .footer{display:none;padding:0 20px 20px;gap:10px}
    .footer.active{display:flex}
    .footer button{flex:1;padding:12px;border-radius:12px;border:0;font-weight:700;cursor:pointer;font-size:1rem}
    .primary{background:var(--btn);color:#fff}
    .primary:active{background:var(--btn-dark)}
    .muted{background:rgba(255,255,255,.08);color:var(--accent-2);border:1px solid rgba(255,255,255,.12)}

    /* Dua cards */
    .dua-card{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:14px 14px 10px}
    .dua-ar{font-size:1.25rem;line-height:1.9;margin-bottom:6px}
    .dua-ur{font-size:1.05rem;color:var(--accent-2);line-height:1.8;margin-bottom:10px}
    .row{display:flex;gap:10px}
    .row .ayah{flex:1;font-size:1rem;padding:10px}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>الکوثر – نماز و تلاوت</h1>
      <div id="crumbs" class="crumbs"></div>
    </header>

    <main>
      <!-- Categories -->
      <div id="categoryList" class="list">
        <button class="item" data-category="namaz">نماز</button>
        <button class="item" data-category="tilawat">تلاوت</button>
        <button class="item" data-category="munajaat">مناجات مقبول</button>
      </div>

      <!-- Items inside a category (Namaz items or Surahs) -->
      <div id="itemList" class="list" style="display:none"></div>

      <!-- Ayat list (for Namaz/Tilawat) -->
      <div id="ayahList" class="list" style="display:none"></div>

      <!-- Munajaat: Days list -->
      <div id="duaDaysList" class="list" style="display:none"></div>

      <!-- Munajaat: Duas for a day -->
      <div id="duaList" class="list" style="display:none"></div>

      <!-- Back -->
      <div id="backWrap" style="display:none;padding:0 20px 20px">
        <button id="backBtn" class="back">⬅️ واپس جائیں</button>
      </div>

      <!-- Controls -->
      <section id="controls" class="controls">
        <div class="group">
          <label for="repeatCount">دہرائی (Repeat) – بار</label>
          <input id="repeatCount" type="number" min="1" max="50" value="3" inputmode="numeric"/>
          <div><label for="autoAdvance">خود اگلی آڈیو چلائیں</label> <input id="autoAdvance" type="checkbox" checked/></div>
        </div>
        <div class="group">
          <label for="speed">رفتار (Speed)</label>
          <input id="speed" type="range" min="0.5" max="1.5" step="0.05" value="1"/>
          <div><span id="speedVal">1.00×</span></div>
        </div>
      </section>

      <!-- Footer -->
      <div id="footer" class="footer">
        <button id="stopBtn" class="muted">روکیں</button>
        <button id="repeatAllBtn" class="primary">سب چلائیں</button>
      </div>
    </main>
  </div>

  <script>
    // ---------- Elements ----------
    const titleEl = document.querySelector('header h1');
    const crumbsEl = document.getElementById('crumbs');

    const categoryListEl = document.getElementById('categoryList');
    const itemListEl = document.getElementById('itemList');
    const ayahListEl = document.getElementById('ayahList');

    const duaDaysListEl = document.getElementById('duaDaysList');
    const duaListEl = document.getElementById('duaList');

    const backWrap = document.getElementById('backWrap');
    const backBtn = document.getElementById('backBtn');

    const controlsEl = document.getElementById('controls');
    const footerEl = document.getElementById('footer');

    const stopBtn = document.getElementById('stopBtn');
    const repeatAllBtn = document.getElementById('repeatAllBtn');
    const repeatCountInput = document.getElementById('repeatCount');
    const autoAdvanceChk = document.getElementById('autoAdvance');
    const speedSlider = document.getElementById('speed');
    const speedVal = document.getElementById('speedVal');

    // ---------- State ----------
    let currentAudio = null, currentIndex = -1, remainingRepeats = 1, playingAll = false;
    let buttons = [];
    let currentView = 'categories'; // categories | items | ayahs | days | duas
    let currentCategory = null;     // 'namaz' | 'tilawat' | 'munajaat'
    let currentKey = null;          // item key (for namaz/tilawat)
    let currentDayKey = null;       // day key (for munajaat)

    // ---------- Data ----------
    const namazKeys = ["takbeer","sanaa","tauz","tasmia","fatiha","ruku","tasmeeh","tahmeed","sajda","attahiyat","darood_ibrahimi","dua_rabbana","salaam"];
    const tilawatKeys = ["feel","quraish","kawthar","kafiroon","ikhlas","falaq","naas","ayatul-kursi"];

    const titles = {
      takbeer:"تکبیرِ تحریمہ", sanaa:"ثنا", tauz:"تعوذ", tasmia:"تسمیہ", fatiha:"سورہ فاتحہ",
      ruku:"رکوع", tasmeeh:"تسمیع", tahmeed:"تحمید", sajda:"سجدہ",
      attahiyat:"التحیات", darood_ibrahimi:"درودِ ابراہیمی", dua_rabbana:"دعا (رَبَّنَا)", salaam:"سلام",
      feel:"سورۃ الفیل", quraish:"سورۃ قریش", kawthar:"سورۃ الکوثر", kafiroon:"سورۃ الکافرون",
      ikhlas:"سورۃ الاخلاص", falaq:"سورۃ الفلق", naas:"سورۃ الناس", "ayatul-kursi":"آیت الکرسی"
    };

    const surahs = {
      takbeer:["اللهُ اکبر"],
      sanaa:["مکمل ثنا","سُبْحَانَکَ اللّٰهُمَّ وَبِحَمْدِکَ","وَتَبَارَکَ اسْمُکَ","وَتَعَالیٰ جَدُّکَ","وَلَا اِلٰهَ غَيْرُکْ"],
      tauz:["اَعُوْذُ بِاللّٰہِ مِنَ الشَّیْطٰنِ الرَّجِیْم"],
      tasmia:["بِسْمِ اللّٰہِ الرَّحْمٰنِ الرَّحِیْم"],
      fatiha:["مکمل سورہ فاتحہ","اَلْحَمْدُ لِلّٰهِ رَبِّ الْعٰلَمِيْنَ","الرَّحْمٰنِ الرَّحِيْمِ","مٰلِكِ يَوْمِ الدِّيْنِ","اِيَّاكَ نَعْبُدُ وَاِيَّاكَ نَسْتَعِيْنُ","اِهْدِنَا الصِّرَاطَ الْمُسْتَقِيْمَ","صِرَاطَ الَّذِيْنَ اَنْعَمْتَ عَلَيْهِمْ ەۙ غَيْرِ الْمَغْضُوْبِ عَلَيْهِمْ وَلَا الضَّاۤلِّيْنَ"],
      ruku:["سُبْحَانَ رَبِّيَ الْعَظِيْمِ"],
      tasmeeh:["سَمِعَ اللّٰهُ لِمَنْ حَمِدَهٗ"],
      tahmeed:["رَبَّنَا لَكَ الْحَمْدُ"],
      sajda:["سُبْحَانَ رَبِّيَ الْأَعْلٰى"],
      attahiyat:["مکمل التحیات","اَلتَّحِيَّاتُ لِلّٰهِ وَالصَّلَوٰتُ وَالطَّيِّبَاتُ","اَلسَّلَامُ عَلَيْكَ اَيُّهَا النَّبِيُّ","وَرَحْمَةُ اللّٰهِ وَبَرَكَاتُهٗ","اَلسَّلَامُ عَلَيْنَا وَعَلٰی عِبَادِ اللّٰهِ الصَّالِحِيْن","اَشْهَدُ اَنْ لَّا اِلٰهَ اِلَّا اللّٰهُ","وَاَشْهَدُ اَنَّ مُحَمَّدًا عَبْدُهٗ وَرَسُوْلُهٗ"],
      darood_ibrahimi:["اَللّٰهُمَّ صَلِّ عَلٰی مُحَمَّدٍ وَّعَلٰى اٰلِ مُحَمَّدٍ","كَمَا صَلَّيْتَ عَلٰى اِبْرَاهِيْمَ وَعَلٰى اٰلِ اِبْرَاهِيْمَ","اِنَّكَ حَمِيْدٌ مَّجِيْدٌ","اَللّٰهُمَّ بَارِكْ عَلٰی مُحَمَّدٍ وَّعَلٰى اٰلِ مُحَمَّدٍ","كَمَا بَارَكْتَ عَلٰى اِبْرَاهِيْمَ وَعَلٰى اٰلِ اِبْرَاهِيْمَ","اِنَّكَ حَمِيْدٌ مَّجِيْدٌ"],
      dua_rabbana:["رَبَّنَا اٰتِنَا فِي الدُّنْيَا حَسَنَةً","وَّفِي الْاٰخِرَةِ حَسَنَةً","وَّقِنَا عَذَابَ النَّارِ"],
      salaam:["اَلسَّلَامُ عَلَيْكُمْ وَرَحْمَةُ اللّٰه - اَلسَّلَامُ عَلَيْكُمْ وَرَحْمَةُ اللّٰه"],

      feel:["مکمل سورہ فیل","أَلَمْ تَرَ كَيْفَ فَعَلَ رَبُّكَ بِأَصْحَابِ الْفِيلِ","أَلَمْ يَجْعَلْ كَيْدَهُمْ فِي تَضْلِيلٍ","وَأَرْسَلَ عَلَيْهِمْ طَيْرًا أَبَابِيلَ","تَرْمِيهِمْ بِحِجَارَةٍ مِّن سِجِّيلٍ","فَجَعَلَهُمْ كَعَصْفٍ مَّأْكُولٍ"],
      quraish:["لِإِيلَافِ قُرَيْشٍ","إِيلَافِهِمْ رِحْلَةَ الشِّتَاءِ وَالصَّيْفِ","فَلْيَعْبُدُوا رَبَّ هَذَا الْبَيْتِ","الَّذِي أَطْعَمَهُم مِّن جُوعٍ وَآمَنَهُم مِّنْ خَوْفٍ"],
      kawthar:["إِنَّا أَعْطَيْنَاكَ الْكَوْثَرَ","فَصَلِّ لِرَبِّكَ وَانْحَرْ","إِنَّ شَانِئَكَ هُوَ الْأَبْتَرُ"],
      kafiroon:["قُلْ يَا أَيُّهَا الْكَافِرُونَ","لَا أَعْبُدُ مَا تَعْبُدُونَ","وَلَا أَنتُمْ عَابِدُونَ مَا أَعْبُدُ","وَلَا أَنَا عَابِدٌ مَّا عَبَدتُّمْ","وَلَا أَنتُمْ عَابِدُونَ مَا أَعْبُدُ","لَكُمْ دِينُكُمْ وَلِيَ دِينِ"],
      ikhlas:["قُلْ هُوَ اللَّهُ أَحَدٌ","اللَّّهُ الصَّمَدُ","لَمْ يَلِدْ وَلَمْ يُولَدْ","وَلَمْ يَكُن لَّهُ كُفُوًا أَحَدٌ"],
      falaq:["قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ","مِن شَرِّ مَا خَلَقَ","وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ","وَمِن شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ","وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ"],
      naas:["قُلْ أَعُوذُ بِرَبِّ النَّاسِ","مَلِكِ النَّاسِ","إِلَٰهِ النَّاسِ","مِن شَرِّ الْوَسْوَاسِ الْخَنَّاسِ","الَّذِي يُوَسْوِسُ فِي صُدُورِ النَّاسِ","مِنَ الْجِنَّةِ وَالنَّاسِ"],
      "ayatul-kursi":[
        "اللَّهُ لَا إِلَٰهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ","لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ","لَهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ",
        "مَن ذَا الَّذِي يَشْفَعُ عِندَهُ إِلَّا بِإِذْنِهِ","يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ","وَلَا يُحِيطُونَ بِشَيْءٍ مِّنْ عِلْمِهِ إِلَّا بِمَا شَاءَ",
        "وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالْأَرْضَ","وَلَا يَئُودُهُ حِفْظُهُمَا","وَهُوَ الْعَلِيُّ الْعَظِيمُ"
      ]
    };

    // Munajaat: Days & Data
    const duaDays = [
      {key:'juma',    label:'جمعہ دعا'},
      //{key:'hafta',   label:'ہفتہ دعا'},
       //{key:'itwar',   label:'اتوار دعا'},
       //{key:'peer',    label:'پیر دعا'},
       //{key:'mangal',  label:'منگل دعا'},
       //{key:'budh',    label:'بدھ دعا'},
       //{key:'jumerat', label:'جمعرات دعا'},
    ];

    // ہر دن کے لیے مثال/Placeholder دعائیں — اپنے اصل متون یہاں رکھ دیں
    // ہر آئٹم: { ar: "...", ur: "..." }
    const munajaat = {
      juma: [
        { ar: "يَارَبِّ يَارَبِّ يَارَبِّ", ur: "اے ميرے پروردگار اے ميرے پروردگار اے ميرے پروردگار " },
        { ar: "اَللّٰہُمَّ يَاكَبِيْرُ يَاسَمِيْعُ يَا بَصِيْرُ ", ur: "يا اللہ اے بڑائی والے اے سننے والے اے ديکھنے والے " },
        { ar: "يَامَنْ لَّاشَرِيْكَ لَہٗ وَلَا وَزِيْرَلَہٗ", ur: "اے   وہ کہ جس کا نہ کوئی شريک ہے اور نہ مشير " },
		{ ar: "وَيَاخَالِقَ   الشَّمْسِ وَالْقَمَرِ الْمُنِيْرِ ", ur: "اے آفتاب و ماہتابِ روشن کے پيدا کرنے والے " },
		{ ar: " وَيَاعِصْمَةَ الْبَآىِٔسِ الْخَآىِٔفِ الْمُسْتَجِيْرِ", ur: "اور اے مصيبت زدہ، ترساں و پناہ جو کے ليے پناہ " },
		{ ar: " وَيَارَازِقَ الطِّفْلِ الصَّغِيْرِ", ur: " اور اے ننھے بچے کی روزی پہنچانے والے " },
		{ ar: "وَيَاجَابِرَ الْعَظْمِ الْكَسِيْرِ", ur: "اور اے ٹوٹی ہوئی ہڈی کے جوڑنے والے " },
		{ ar: "اَدْعُوْكَ دُعَآءَ الْبَآىِٔسِ الْفَقِيْرِ كَدُعَآءِ الْمُضْطَرِّ الضَّرِيْرِ", ur: " ميں تجھ سے درخواست کرتا ہوں مصيبت زدہ محتاج کی سی درخواست، بے قرار آفت زدہ کی سی درخواست " },
		{ ar: "اَسْأَلُكَ بِمَعَاقِدِ الْعِزِّمِنْ عَرْشِكَ وَبِمَفَاتِيْحِ الرَّحْمَةِ مِنْ كِتَابِكَ", ur: " تجھ سے سوال کرتا ہوں تيرے عرش کے بلند ہائے عزّت کے واسطہ سے اور  تيری کتاب کی کليد ہائے رحمت کے واسطہ سے " },
		{ ar: "وَبِالْاَسْمَآءِ الثَّمَانِيَةِ الْمَكْتُوْبَةِ عَليٰ قَرْنِ الشَّمْسِ اَنْ تَجْعَلَ الْقُرْاٰنَ رَبِيْعَ قَلْبِيْ وَجِلَآءَ حُزْنِيْ", ur: " اور  ان آٹھ ناموں کے واسطہ سے جو رُخِ آفتاب پر لکھے ہوئے ہيں، يہ کہ قرآن کو ميرے دِل کی بہار اور ميرے غم کی کشائش بنا دے۔ " },
		{ ar: "رَبَّناۤ اٰتِنَا فِي الدُّنْيَا ﴿ كَذَاوَكَذَا﴾ ", ur: "اے ہمارے پروردگار ہمىں دُنىا مىں فلاں فلاں چىز عطا کر " },
		{ ar: "يَا مُوْنِسَ كُلِّ وَحِيْدٍ", ur: "اے غمگسار ہر اکىلے کے  " },
		{ ar: " وَّيَاصَاحِبَ كُلِّ فَرِيْدٍ", ur: "اور اے رفىق ہر تنہا کے  " },
		{ ar: "وَّيَا قَرِيْبًا غَيْرَ بَعِيْدٍ وَّيَا شَاہِدًا غَيْرَ غَآىِٔبٍ", ur: "اور اےاىسےقرىب جو بعىدنہىں اور اے اىسے حاضر جو غائب نہىں " },
		{ ar: " وَّيَاغَالِبًا غَيْرَ مَغْلُوْبٍ، يَّاحَيُّ يَاقَيُّوْمُ", ur: " اور اے اىسے غالب جو مغلوب نہىں اور ىا حى ىا قىوم " },
		{ ar: "يَاذَالْجَلَالِ وَالْاِكْرَامِ", ur: " اے بزرگى اور عظمت والے  " },
		{ ar: "يَانُوْرَ السَّمٰوٰتِ وَالْاَرْضِ، وَيَازَيْنَ السَّمٰوٰتِ وَالْاَرْضِ", ur: "اور اے آسمانوں اور زمىن کے نور اور اے آسمانوں اور زمىن کى زىنت " },
		{ ar: "يَاجَبَّارَ السَّمٰوٰتِ وَالْاَرْضِ", ur: " اے انتظام رکھنے والے آسمانوں اور زمىنوں کے " },
		{ ar: "يَا عِمَادَ السَّمٰوٰتِ وَالْاَرْضِ", ur: " اور اے آسمانوں اور زمىن کے تھامنے والے " },
		{ ar: " يَابَدِيْعَ السَّمٰوٰتِ وَالْاَرْضِ", ur: " اور اے آسمانوں اور زمىن کے موجد " },
		{ ar: " وَيَاقَيَّامَ السَّمٰوٰتِ وَالْاَرْضِ", ur: " اور اے آسمانوں اور زمىن کے قائم رکھنے والے  " },
		{ ar: "يَاذَالْجَلَالِ وَالْاِكْرَامِ يَاصَرِيْخَ الْمُسْتَصْرِخِيْنَ وَمُنْتَہَي الْعَآىِٔذِيْنَ", ur: "اور اے بزرگى اور عظمت والے اے فرىادىوں کے داد رس اور پناہ مانگنے والوں کى آخرى دوڑ " },
		{ ar: " وَالْمُفَرِّجُ عَنِ الْمَكْرُوْبِيْنَ", ur: " اور اے بے چىنوں کے کشائش دىنے والے " },
		{ ar: " وَالْمُرَوِِّحُ عَنِ الْمَغْمُوْمِيْنَ، وَمُجِيْبَ دُعَآءِ الْمُضْطَرِّيْنَ", ur: " اور غمزدوں کے راحت دىنے والے اور بے قراروں کى دُعا قبول کرنے والے  " },
		{ ar: "وَيَاكَاشِفَ الْمَكْرُوْبِ", ur: "اور اے صاحبِ کرب کو شفا دىنے والے  " },
		{ ar: " يَاۤاِلٰہَ الْعٰلَمِيْنَ وَ يَاۤاَرْحَمَ الرّٰاحِمِيْنَ مَنْزُوْلٌۭ بِكَ كُلُّ حَاجَۃٍ", ur: "اے الٰہ العالمىن اور اے سب رحم کرنے والوں سے بڑھ کر رحم کرنے والے، تىرے ہى سامنے ہر حاجت پىش ہے۔ " },
		  ],
		  
      hafta: [
        { ar: "— یہاں ہفتہ کی عربی دعا ۱ —", ur: "— یہاں اردو ترجمہ ۱ —" },
        { ar: "— یہاں ہفتہ کی عربی دعا ۲ —", ur: "— یہاں اردو ترجمہ ۲ —" },
      ],
      itwar: [
        { ar: "— یہاں اتوار کی عربی دعا ۱ —", ur: "— یہاں اردو ترجمہ ۱ —" },
      ],
      peer: [
        { ar: "— یہاں پیر کی عربی دعا ۱ —", ur: "— یہاں اردو ترجمہ ۱ —" },
      ],
      mangal: [
        { ar: "— یہاں منگل کی عربی دعا ۱ —", ur: "— یہاں اردو ترجمہ ۱ —" },
      ],
      budh: [
        { ar: "— یہاں بدھ کی عربی دعا ۱ —", ur: "— یہاں اردو ترجمہ ۱ —" },
      ],
      jumerat: [
        { ar: "— یہاں جمعرات کی عربی دعا ۱ —", ur: "— یہاں اردو ترجمہ ۱ —" },
      ],

    };

    // ---------- Helpers ----------
    function setCrumbs(parts){ crumbsEl.textContent = parts.filter(Boolean).join(" › "); }
    function updateSpeedLabel(){ speedVal.textContent = Number(speedSlider.value).toFixed(2)+'×'; }
    updateSpeedLabel();
    speedSlider.addEventListener('input',()=>{ updateSpeedLabel(); if(currentAudio) currentAudio.playbackRate = Number(speedSlider.value); });

    function clearPlayingStyles(){ buttons.forEach(b=>b.classList.remove('playing')); }
    function stopPlayback(){ playingAll=false; if(currentAudio){ currentAudio.pause(); currentAudio=null; } clearPlayingStyles(); currentIndex=-1; }
    stopBtn.addEventListener('click', stopPlayback);

    function playIndex(ix){
      const btn = buttons[ix]; if(!btn) return;
      if(currentAudio){ currentAudio.pause(); currentAudio=null; }
      clearPlayingStyles(); btn.classList.add('playing');
      const audio = new Audio(btn.dataset.file); audio.playbackRate = Number(speedSlider.value);
      currentAudio = audio; currentIndex = ix; remainingRepeats = Number(repeatCountInput.value || 1);
      audio.addEventListener('ended', ()=>{
        remainingRepeats--;
        if(remainingRepeats>0){ audio.currentTime=0; audio.play(); }
        else if(playingAll || autoAdvanceChk.checked){
          if(ix+1<buttons.length) playIndex(ix+1); else { playingAll=false; clearPlayingStyles(); }
        } else clearPlayingStyles();
      });
      audio.play();
    }
    repeatAllBtn.addEventListener('click',()=>{ playingAll=true; playIndex(0); });

    // ---------- Build Lists ----------
    function openCategory(cat){
      currentCategory = cat;
      if(cat==='namaz'){ titleEl.textContent='نماز – اذکار و قراءت'; setCrumbs(['نماز']); buildItems(namazKeys); show('items'); }
      else if(cat==='tilawat'){ titleEl.textContent='تلاوت – سورتیں و آیات'; setCrumbs(['تلاوت']); buildItems(tilawatKeys); show('items'); }
      else if(cat==='munajaat'){ titleEl.textContent='مناجات مقبول – ایام'; setCrumbs(['مناجات مقبول']); buildDuaDays(); show('days'); }
    }

    function buildItems(keys){
      itemListEl.innerHTML='';
      keys.forEach(key=>{
        const b=document.createElement('button');
        b.className='item';
        b.textContent=titles[key]||key;
        b.dataset.key=key;
        b.addEventListener('click',()=>openKey(key));
        itemListEl.appendChild(b);
      });
    }

    function openKey(key){
      currentKey = key;
      setCrumbs([ currentCategory==='namaz'?'نماز':'تلاوت', titles[key]||key ]);
      const ayahs = surahs[key] || [];
      ayahListEl.innerHTML='';
      ayahs.forEach((text,i)=>{
        const b=document.createElement('button');
        b.className='ayah';
        b.textContent=text;
        b.dataset.file=`audio/${key}${i+1}.mp3`;
        b.addEventListener('click',()=>{ playingAll=false; playIndex(i); });
        ayahListEl.appendChild(b);
      });
      buttons = Array.from(ayahListEl.querySelectorAll('button.ayah'));
      show('ayahs');
    }

    function buildDuaDays(){
      duaDaysListEl.innerHTML='';
      duaDays.forEach(d=>{
        const b=document.createElement('button');
        b.className='item';
        b.textContent=d.label;
        b.dataset.day=d.key;
        b.addEventListener('click',()=>openDay(d.key, d.label));
        duaDaysListEl.appendChild(b);
      });
    }

    function duaAudioPath(dayKey, i, lang){ // lang: 'ar' | 'ur'
      return `audio/munajaat/${dayKey}${i+1}-${lang}.mp3`;
    }

    function openDay(dayKey, dayLabel){
      currentDayKey = dayKey;
      titleEl.textContent = `مناجات مقبول – ${dayLabel}`;
      setCrumbs(['مناجات مقبول', dayLabel]);

      const items = munajaat[dayKey] || [];
      duaListEl.innerHTML='';
      items.forEach((du,i)=>{
        const card=document.createElement('div'); card.className='dua-card';

        const ar=document.createElement('div'); ar.className='dua-ar'; ar.textContent=du.ar||'';
        const ur=document.createElement('div'); ur.className='dua-ur'; ur.textContent=du.ur||'';

        const row=document.createElement('div'); row.className='row';
        const bAr=document.createElement('button');
        bAr.className='ayah'; bAr.textContent='▶ عربی آڈیو';
        bAr.dataset.file = duaAudioPath(dayKey,i,'ar');
        bAr.addEventListener('click',()=>{ playingAll=false; playIndex(buttons.indexOf(bAr)); });

        const bUr=document.createElement('button');
        bUr.className='ayah'; bUr.textContent='▶ ترجمہ آڈیو';
        bUr.dataset.file = duaAudioPath(dayKey,i,'ur');
        bUr.addEventListener('click',()=>{ playingAll=false; playIndex(buttons.indexOf(bUr)); });

        row.appendChild(bAr); row.appendChild(bUr);
        card.appendChild(ar); card.appendChild(ur); card.appendChild(row);
        duaListEl.appendChild(card);
      });

      // ترتیب کے مطابق موجودہ ویو کے تمام آڈیو بٹن پکڑ لیں
      buttons = Array.from(duaListEl.querySelectorAll('button.ayah'));
      show('duas');
    }

    // ---------- View Switcher ----------
    function show(view){
      // hide all
      categoryListEl.style.display='none';
      itemListEl.style.display='none';
      ayahListEl.style.display='none';
      duaDaysListEl.style.display='none';
      duaListEl.style.display='none';
      controlsEl.classList.remove('active');
      footerEl.classList.remove('active');

      if(view==='categories'){
        categoryListEl.style.display='grid'; backWrap.style.display='none';
        titleEl.textContent='الکوثر – نماز و تلاوت'; setCrumbs([]);
      }
      if(view==='items'){
        itemListEl.style.display='grid'; backWrap.style.display='block';
      }
      if(view==='ayahs'){
        ayahListEl.style.display='grid'; backWrap.style.display='block';
        controlsEl.classList.add('active'); footerEl.classList.add('active');
      }
      if(view==='days'){
        duaDaysListEl.style.display='grid'; backWrap.style.display='block';
      }
      if(view==='duas'){
        duaListEl.style.display='grid'; backWrap.style.display='block';
        controlsEl.classList.add('active'); footerEl.classList.add('active');
      }
      currentView = view;
    }

    // ---------- Events ----------
    // Category clicks
    categoryListEl.querySelectorAll('button.item').forEach(btn=>{
      btn.addEventListener('click',()=>openCategory(btn.dataset.category));
    });

    // Back behaviour
    backBtn.addEventListener('click', ()=>{
      stopPlayback();
      if(currentView==='duas'){ show('days'); setCrumbs(['مناجات مقبول']); titleEl.textContent='مناجات مقبول – ایام'; return; }
      if(currentView==='days'){ show('categories'); return; }
      if(currentView==='ayahs'){ show('items'); setCrumbs([ currentCategory==='namaz'?'نماز':'تلاوت' ]); return; }
      if(currentView==='items'){ show('categories'); return; }
      show('categories');
    });

    // Init
    show('categories');
  </script>
</body>
</html>
